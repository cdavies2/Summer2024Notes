# What is a Narrative?
* Narratices are shareable, reproducible workflows that include data, analysis steps, results, visualizations, and commentary.

# Steps to Create and Use the Features of Narratives
1. Create a New Narrative-click the "+ New Narrative" button in Narratives to open a new unitled narrative. A "Welcome to the Narrative Interface" box offers information and links to documentation for adding content to your Narrative. The "Narrative Tour" feature walks you through the user interface, pointing out various useful aspects of it.
2. Find Data to Analyze-to load data to your Narrative, click the "Add Data" button in the Data Panel, which can be found under the Analyze tab near the top left of the Narrative. The Data Browser will slide out with tabs that show several data sources. You can choose a dataset already in KBase by selecting any of the first four tabs, and the Import tab allows you to upload your own data (which is private unless you choose to share it)
3. Add Data to your Narrative-when you hover over a data object in the Data Browser, a blue "<Add" button will appear to its left, and click the button to add the data to your Narrative. Once you finish adding data, exit the Data Browser by clicking either the "Close" button at the bottom left of the browser window or the arrow at the top right of the Data Panel.
4. Choose an App-once you've added data to your Narrative, you can analyze it using one or more of the KBase apps listed in the App Panel below your data. To add an app to your Narrative from the App Panel, click on its name or icon. You can get more information about an app by hovering over it until "..." and clicking on it
5. Run the App-fill all the required fields in your app. "Smart" fields have a pulldown list of all the data objects from your Data Panel that you can choose from as input. When all required fields have been filled out, click the green "Run" button at the top left of the app cell to start the analysis.
6. Share Your Narrative-All Narratives that you create are private by default. You can make a Narrative public or share it with specific collaborators by clicking the "share" button near the top right of your Narrative.

## Access the Narrative Interface
* There are several ways to enter the Narrative Interface from KBase:
  * Use the menu at the top left of the landing page and select "Narrative Interface"
  * Open a public Narrative or one that has been shared with you
  * Start a new Narrative by clicking the "+ New Narrative" button

## Managing Narratives and Accessing Resources
 1. Top Menu-menu options are accessed by clicking the three dark grey horizontal lines on the upper left of the window, and said options include...
    * Narrative Interface-lets you access other Narratives from a Narrative. It also allows you to create, edit, run, and share Narratives
    * About the Narrative-opens a window describing Narrative Interface properties (including version number) and provides a link to notes about the latest KBase release
    * Shutdown and Restart-closes and relaunches the Narrative Interface (which can be useful if content doesn't load or if the narrative freezes).
    * The top level menu (three small blue horizontal lines) has additional options...
      *   New Narrative-opens a new Narrative in a new window
      *   JGI Search-goes to the Data Search tab
      *   Biochem Search-goes to the Compound and Reaction search tabs
      *   KBase Services Status-describes current version of the narrative interface
      *   About-describes interface and connects to the KBase GitHub.
      *   Contact KBase-lets you contact the KBase Help Desk
      *   Support-brings you to the Narrative User Guide
 2.  KBase Logo-links to the KBase home page
 3.  Narrative Title and Creator-lets you name (or rename) your Narrative
 4.  Toggle View-Only Mode-in view-only you can look at the narrative but not run or change it
 5.  Narrative Controls...
  * Help Menu ("?")-links to documentation and the Narrative Tour
    * Kernel menu-intended for developers
    * Share button-make Narrative public or give access to specific KBase users
    * Save-saves work
    * User icon-sign in/out or access your user profile  
 6.  Narrative Tabs-Analyze (data panel and Apps panel) and Narratives (allows you to create a new Narrative, copy an existing Narrative, and see a list of other Narratives created by or shared with you)

## Adding Data and Apps
7. Data Panel-You can add data to your narrative by searching KBase's reference collection, importing datasets, or generating new data from KBase analyses. All data from these activities will be listed in this panel.
8. Data Panel Controls-use these icnons to search, filter, sort, and refresh the data in your panel.
9. Data Object-each data object in the panel can be expanded to see more information about the data and several options for downloading, viewing data provenance, and more
10. Add Data-opens the data browser, provides options for working with your own data or data from KBase's reference collection.
11. Apps Panel-lists KBase analysis functions
12. App Controls-search and refresh the list of apps, as well as expose apps that are available but still in beta. Right arrow opens the App Catalog, which provides advanced options for browsing apps (designating them as favorites, filtering based on popularity)

## Running Analyses and Adding Commentary
13. Markdown cell-markdown language can add text commentary and graphics
14. Data Cell-share details and describe individual data objects present within the Narrative.
15. App Cell-display app inputs and outputs, text and commentary, and code cells for writing custom scripts
16. Markdown and Code Cell Buttons-click to add these types of cells to the Narrative

# Narrative Navigator
* There are five tabs for exploring and locating existing Narratives: My Narratives, Shared with Me, Tutorials, and Public.
* The most recently updated Narratives appear first, but can be searched or sorted using the dropdown menu - Recently updated, Least recently updated, Recently created, Oldest, Lexographic (A-Z), Reverse Lexicographic (Z-A).
* A list of available Narratives will be on the left panel and information on the selected Narrative on the right panel. Here you can see an overview of the Data within the Narrative and a Preview.
 * Icons under a Narrative name indicate which apps the Narrative includes, how many markdown and code cells it contains, the number of times the Narrative has been shared, whether there are any running jobs, total running time for all completed jobs, and more.
* Click on the selected Narrative name to open it
* The Gear icon next to the Narrative title allows you to manage sharing, copy a narrative, rename, link to an organization, or delete.
## Where Can I Go From Here?
* Navigator-takes you to your accessible Narratives
* Orgs-takes you to a list of Organizations within KBase ("My Orgs" shows the Organizations you belong to as a member)
* Catalog-you can use the App Catalog to browse, search for, and see specifications of KBase apps
* Search-allows you to search for data present in your own Narratives, those shared with you, those made public by their owners; you can also search for reads and assemblies contained in the Joint Genome Institute (JGI) Genomes Online Database (GOLD) and add them to your Narratives
* Jobs-allows you to view apps that have you've run recently, see their progress, search for specific runs, and more.
* Account-you can edit your profile information in the account manager, and get to your Profile Page, which gives an overview of your Narratives and Collaborators
* Feeds-takes you to the Notification Feeds page to view notifications from KBase.

# Explore Data
## The Data Browser
* The Data Browser slide-out is accessed throught the right-facing arrow in the menu or the red "Add Data" button in the Data Pane.
 * My Data-data you've already loaded or analyzed in another Narrative
 * Shared with Me-data included in Narratives that have been shared with you
 * Public-data in KBase that's accessible to everyone
 * Example-example datasets that can be used as inputs to apps and methods
 * Import-mechanism allowing you to import your own data to your Narrative.
* If you hover over a data object in the Data Browser panel, three icons appear
   1. "<Add"-adds the data object to your Narrative
   2. Binoculars Icon-opens a Data Landing page
   3. Graph-like Icon-opens a Provenance page
 ## Information in the Data Pane
 * The Data Pane shows all the data that you've added to your Narrative. You can access more details about a particular data object by hovering over the object and clicking the "..." that appears in the right-hand side.
 * Page with three lines and folded corner-the "View Associated Report" button, opens the Data View report page for the data object.
 * Counter clockwise clock-the "View History to Revert Changes" icon, which allows you to see and revert to previous versions of the data.
 * Download icon-lets you download a data object to your local computer in JSON format
 * A-"Rename data", lets you rename your data object.
 * Trash can-delete data from your Narrative

# Data Viewers
* They can be accessed two ways from the Data Panel
  1. Click the name of a data object, and its viewer will be added to your Narrative
  2. Drag the object from the Data Panel and drop it into the main part of your Narrative
  * You can sort table entries by clicking on a column header to sort by that field, and clicking the same header again will reverse the sort order. You can sort by more than one column at a time by clicking one column header and shift-clicking other column headers.

# Data Landing and Provenance Pages
* Data Landing pages provide both known and contextual information about a data object, allowing users to examine various particulars about data, and compare it to other data objects. You will see a data object summary, a genome overview panel that lists information about the genome (biological domain, DNA length, etc), publications that mention this genome, taxonomic lineage, a species tree, functional categories, etc
* Provenance Pages-one way to facilitate reproducibility and transparency of scientific results. This page records and illustrates how data is derived and modified in KBase, including how it entered the system, whether it was produced through analysis of other objects, who generated the data, and when.

## Add Data to Your Narrative
* The Data Panel in a Narrative shows the data objects that are currently available in that particular Narrative.
* Click the "Add Data", "+", or top right arrow buttons to access the Data Browser slide-out
* The Example tab in the browser shows datasets that have been pre-loaded for use with particular apps (handy for trying out the Narrative Interface)
* The Import tab allows you to upload your own datasets for analysis.

## Data Available in KBase
* Hovering your cursor over a data object gives you options, allowing you to add that object to the Narrative or find out more about it.
* The icon to the left of each data object represents its data type.
* The blue "<Add" button next toeach icon lets you add the data object to your Narrative

## Uploading Data from External Sources
* The Import tab lets you drag and drop data from your computer into your Staging Area to import into your Narrative, where you can then analyze it using KBase's analysis apps. Getting data from your computer to the KBase Narrative takes three steps...
  1. Drag and drop the data file(s) from your computer to the new Import tab to upload them to your Staging Area (private, temporary holding place for uploaded data files)
  2. Choose a format for importing data from your Staging Area into your Narrative
  3. Run the Import app that is created.

 ## Drag and Drop Data Files Into your Staging Area
 * Find the file(s) you want to import into your KBase account, and drag them into the drop zone (dotted line rectangle). You could also click the upload area to open a file chooser and select a file from your computer to upload.
 * By default, files are sorted by age, with the most recent at the top. To sort by other fields, like name or size, click a column header.
 * Files in the Staging Area are automatically removed after 90 days, but Data Objects imported into a Narrative will exist indefinitely.

## Transferring Data from a Globus Endpoint
* Globus is a data manageemnt and file transfer system that can facilitate bulk transfer of data between two endpoints. This requires a Globus account.

## Uploading Data from a URL
* Clicking the "Upload with URL" button adds the "Upload File to Staging from Web" App to your Narrative. There are also several apps that import specific file types (like SRA files) directly to your Narrative, bypassing your Staging Area.

## Importing Files from the Staging Area to the KBase Narrative
* To import a file from your Staging Area, choose a format (data type) from the pulldown menu to the right of the file's age. When you click the import icon, an Import App cell for each data type or a Bulk Import App cell will be created in your Narrative, with the appropriate parameters filled in.
* If import is successful, you can see the new data object in your Data Panel.
* Sometimes an import doesn’t work. One of the most common causes of failure is attempting to import a file that’s the wrong data type, or not the expected format for that data type. If the importer objected to something in your file, check the Data Upload/Download guide or contact the KBase help board.

## Bulk Import for Multiple Files
* Multiple files can be imported together in a single Import App as part of the bulk import feature. When you click multiple files and use "import selected", there will be a new cell type which contains a tab for each different file type you selected from the staging area. You fill out the same parameters for each file type by clicking the file type in the "Data Types" column on the left; these are the same parameters as single imports.
* Supported file types include:
  * Assembly - FASTA
  * SRA Reads
  * FASTQ Reads Interleaved - FASTQ Interleaved reads
  * FASTQ Reads Noninterleaved - FASTQ paired-end reads or FASTQ single-end reads library
  * GenBank Genome - GenBank
  * GFF Metagenome - FASTA and GFF3

 # Browse KBase Analysis Tools
 * Apps in the Apps Panel are grouped by category. Click the arrow to the left of a category name to see individual apps in that category.
 * You can browse KBase Apps by
   1. Scrolling through the list in the apps panel
   2. Searching for an app by name
   3. Using the App Catalog (click the right arrow in the top right corner of the Apps Panel to open it) to further explore, filter, and designate apps as favorites.

 # Analyze Data Using KBase Apps
 * To add a KBase analysis app, find the app of interest and click its name or the icon to the left of the app name. A box (called a cell) containing the chosen app will appear in the main Narrative panel.
 * App Cells have three tabs
   1. Configure
   2. Info
   3. Job Status and Result
  ## Fill In Parameters
  * After you add an app to your Narrative, the required parameters must be filled in before you can run it. For most apps, you need to select the input data object(s)
  * A red bar to the right of a field indicates that it is a required field and you have not yet entered a valid value in it. Once you have filed or corrected the field, the indicator should disappear.
  * Some app fields are "smart" and know which data in your Narrative is valid for that field. These "smart" fields have a pulldown list of data objects that you can choose from. Some fields are also required, but they will be pre-filled with default values. Some apps also have optional "advanced options" that you can reveal by clicking on the "advanced options" link at the bottom of the cell.
## Run the App
* When you've filled in the required fields, the Run button will be enabled. The analysis will continue running even if you don't have the narrative open
* When an app finishes running, you will see a summary in the Results tab, as well as an output cell below your app cell. Also, if the analysis generates a new data object, that object will be added to your Data Panel.
* Different apps create different types of output cells when they run, depending on which type of data object is output by the app.
## Conduct Further Analyses
* Once you have reviewed your results, you can use your newly generated data in additional analysis steps. Remember, you can click on the data object in the Data Panel to see which KBase Apps work with that data type.
## Re-Run Apps with the Same or Different Parameters
* App input cells that have already been run have a "Reset" button that allows you to redo the analysis, with the option to change any of the parameter settings (including the input data) before rerunning. Rerunning an App will overwrite the information in the App cells, but will not overwrite any data objects in your Narrative unless you use the same output object name again
## Report Errors
* If a job fails, you will see an error message in the output cell and/or in the Result tab. If you need help, contact KBase, and include the contents of the Job Status tab and the URL of your narrative to help them debug the problem.

# Job Browser
* In addition to viewing job status within a Narrative, the Job Browser allows you to monitor and manage your jobs across Narratives. By default, it shows all jobs submitted within the Previous Week (you can change the timeframe)
* You can filter jobs by Created, Queued, Running, Completed, Error, and Canceled
* The results display basic information for jobs like the Narrative they are located, App, date submitted, Run time, Server, and if the job was Canceled.
 ## Job Status
 * The overall Job status is stated in the Status column. To inspect the Job Log, click the i icon to open the table to see the contents of the log.
 ## Job Log
 * The Job ID and worker node are easily located and the log can be scrolled through within the pop-out. Job Logs can be downloaded in CSV, TSV, JSON, and TEXT formats

  # Revise Your Narrative
  * Your Narratives are shown in the Narratives tab in reverse chronological order, with the most recently updated Narrative first.
  * KBase stores a history of everything you've done to your Narrative, so you are able to revert changes and go back to an earlier version. When you hover your cursor over one of your Narratives in the Narratives panel, three icons appear, the first of which lets you access prior saved versions of the Narrative.
  * You can add formatted text to your Narrative (to explain what you're doing) via Markdown Cells. To edit a Markdown cell, double-click it to enter edit mode, and when you're done, press Shift-Return to exit the cell.
  * The cell menu can be opened by clicking the "..." icon in the upper right corner of a cell.
  * To rename a Narrative, click on its name at the top of the Narrative window. To delete a Narrative, click the trash can (but be careful, there's no way to get your deleted Narrative back)
  * Save your work frequently using the Save button at the top right of the screen.
*
